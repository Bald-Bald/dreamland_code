<pre>        
Логи бесед о Фене в обработке Кинд.
Все действия первого лица (Филдса и Руфины) отмечены знаком &gt;&gt; в случаи разговора
и $ при вводе команды.

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;  PART 1 (from Filths) &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
Колдунья Kind произносит 'поговорим о фене?'
Filths кивает с глупым видом.

Колдунья Kind произносит 'у меня всего один вопрос'
 &gt;&gt; 'я не доктор, но посмотреть могу (с) %)'

Колдунья Kind произносит 'как прикрутить ее к реальной ситуации'
Ruffina произносит '(кстати можете на тестовый переместиться, там Кинд сразу экспериментировать сможет)'

 &gt;&gt; 'ээ.. в философском смысле?'
Колдунья Kind произносит 'нет - в смысле кода'

 &gt;&gt; 'про ситуацию..'
Ruffina произносит 'щас я туда Филдса положу, wait.'
 &gt;&gt; 'всмысле, какой командой?'

Колдунья Kind произносит 'можешь показать как все делается на малюсеньком примере'
Filths кивает с глупым видом.
 &gt;&gt; 'вот моб..'
Ты показываешь на Ruffina.
Колдунья Kind произносит 'ага'
Ruffina хихикает.
Ruffina произносит 'так и знала :))'
 &gt;&gt; 'сейчас ей прогу повесим'
Ruffina щипает тебя за попку!

 &gt;&gt; 'ладно. Этому'
Ты показываешь на сатира-пьяницу.
 &gt;&gt; 'так'
Колдунья Kind смотрит на сатира-пьяницу.

 &gt;&gt; 'bubu'
Сатир-пьяница щипает Колдунья Kind за попку и ухмыляется.

 &gt;&gt; 'О.'
 &gt;&gt; 'повесил. Теперь смотри как.'

Колдунья Kind произносит 'bubu'
Сатир-пьяница щипает Колдунья Kind за попку и ухмыляется.

Колдунья Kind хихикает.
Колдунья Kind произносит 'приятно'
Колдунья Kind кивает тебе.

 &gt;&gt; 'eval get_char_room("satyr").onSpeech = function(vict, msg) { if(msg.match("bubu")) interpret("pinch kind"); }'

 &gt;&gt; 'eval - это команда.'
 &gt;&gt; 'в параметы ей передается выражение на фене'
 &gt;&gt; 'в левой части присваивания перется поле onSpeech'
 &gt;&gt; 'от объекта,который вернул метод get_char_room'
 &gt;&gt; 'в данном случае - это присваивание'
 &gt;&gt; 'присваивание - частный случай выражения.'

Колдунья Kind произносит 'ясно - давай про поле'
Колдунья Kind произносит 'указатель на функцию которую надо вызвать если кто-то что-то сказал?'

 &gt;&gt; 'в фене вообще говоря нет функций как в си. Есть только поля и переменные.  Но один из типов данных, который может хранить поле и переменная - функция.'
 &gt;&gt; 'да. можно считать, что все переменные кроме чисел и строк являются указателями кудато'

Колдунья Kind произносит 'обьясни параметры'
Колдунья Kind произносит 'почему везде одинаковые (вроде)'

 &gt;&gt; 'ээ.. victim, msg?'
Колдунья Kind произносит 'да'

 &gt;&gt; 'victim  - это кто сморознул фразу. msg - что именно сморознул.'

Колдунья Kind произносит 'это ясно - откуда феня это знает'

 &gt;&gt; 'имена могут быть любыми'
 &gt;&gt; 'важен порядок и колличество.'
 &gt;&gt; 'типа, про позицию аргументов'
 &gt;&gt; 'можно считать, что из мира, когда кто-то что-то говорит для всех чаров в комнате делается вызов v.onSpeech(ch, txt)'
 &gt;&gt; 'тут v - это подряд все чары в комнате'
 &gt;&gt; 'ch - кто сказал, txt - что сказал.'
 &gt;&gt; 'имена параметров в объявлении функции - это просто локальные переменные. Назови хоть a и b.'


 &gt;&gt; 'eval get_char_room("satyr").onSpeech = function(vict, msg) { if(msg.match("bubu")) interpret("pinch kind"); }'

Колдунья Kind произносит 'а msg - обьект фени?'
 &gt;&gt; 'msg - это строка.'
 &gt;&gt; 'о'
Колдунья Kind произносит 'туплю'

 &gt;&gt; 'вот сейчас пример покажу.'

Колдунья Kind произносит 'а что тогда msg.match?'
 &gt;&gt; 'метод строки'

Колдунья Kind произносит '?!!'

Колдунья Kind произносит 'bububu'
Сатир-пьяница щипает Колдунья Kind за попку и ухмыляется.

[prompt skilled]&gt;&gt; '"3452345bubu345345".match("bubu") - истина.'

 &gt;&gt; 'ты на яве писал что-то?'
Колдунья Kind произносит 'неа'

 &gt;&gt; 'там строка - это класс java.lang.String. У него туевая хуча методов.'
 &gt;&gt; 'здесь не туевая, но есть. Так удобней. Есть toLower, toUpper и т.п.'

Колдунья Kind произносит 'ладно - пофиг, где их можно увидеть?'
Ты вздыхаешь.
 &gt;&gt; 'в исходниках сишных'
 &gt;&gt; 'а'
 &gt;&gt; 'нет'
 &gt;&gt; 'все они есть в существующих мобпрогах :)'
 &gt;&gt; 'потому, что появляются только по необходимости'

Колдунья Kind произносит 'у меня есть только одна'

 &gt;&gt; 'я прошу у рыжей чего-то, она прикручивает.'
 &gt;&gt; 'есть еще бар Дальтовский. Но там ничего нового вроде нет.'
 &gt;&gt; 'и есть пропостание конопли.. но оно не доделаное.'
 &gt;&gt; 'там пару примитивных прог - реакция бармена на вход дальта и других посетителей. Пару спич прог и все.'

Колдунья Kind произносит 'может ли такая фича прокатить с комнатами?'

 &gt;&gt; 'нет. Там проверка есть. через метод персонажа isNpc()'
 &gt;&gt; 'может любая - не хватает какой-то функции, говоришь чего надо и ее добавляют.'

Колдунья Kind произносит 'тебе легко говорить'
Колдунья Kind произносит 'когда трудно понять что именно нужно )'
 &gt;&gt; 'пиши, будто все уже есть и называй как вздумается. Я так еврея писал.'

Колдунья Kind произносит 'с комнатами что-то делал?'
 &gt;&gt; 'нет. Потому - полная свобода :)'

Колдунья Kind произносит 'вещи?'
 &gt;&gt; 'делал, естесственно :) Еврей же делает что-то'
 &gt;&gt; 'но там тоже мне не хватало многого. put прогу до сих пор Рыжа прикручивает. Хотя там всего пару строк'
Immortal произносит 'ты ж сказал что не надо ее!'
 &gt;&gt; 'ну, не надо - сейчас все работает и так. Была бы put прога - можно было бы сделать оповещение о том, что покрасили что-то уже.'

Колдунья Kind произносит 'а что по поводу процессов?'
 &gt;&gt; 'о'
 &gt;&gt; 'вот тут все готово'
 &gt;&gt; 'с процессами там все просто и много методов не надо.'
 &gt;&gt; 'есть всего (загибает пальцы) три'
 &gt;&gt; '.scheduler.Thread(функция, параметры...) - создает новый стоячий (не запускает всмысле) поток'
 &gt;&gt; 'функция - это то, что будет запущено. Параметры у функции не обязательны.Но если есть, их можно передать в Thread и с ними она вызовется.'
 &gt;&gt; 'Вот у самого потока есть два метода start() и stop(тут необязательная строка)'
 &gt;&gt; 'старт пускает поток, стоп - бросает в нем исключение. Если в стоп передали строку - то она и бросается.'
 &gt;&gt; 'есть еще один вызов - .scheduler.yield() - передать управление следующему потоку.'

Колдунья Kind произносит 'исключения? они что отлавливаются?'
 &gt;&gt; 'да. ты синтаксис читал?'
 &gt;&gt; 'там и пример, вроде, был в книге'
Колдунья Kind произносит 'там все слишком ненаглядно'
 &gt;&gt; 'example throw, вроде'
Колдунья Kind произносит 'это видел'

Колдунья Kind произносит 'что такое поток с твоей точки зрения?'
 &gt;&gt; 'в еврее и потоки и исключения используются.'
 &gt;&gt; 'ооо это философский вопрос. вообще говоря, это абстрацкия, описывающая состояние какого-то процесса.. но тут непонятно как объяснить слово процесс.'
 &gt;&gt; 'ща. вот на примере покажу.'

Колдунья Kind произносит 'давай'
 &gt;&gt; 'смотри.Вот есть какая-то ф-я, которая в цикле печатает двойки.'
 &gt;&gt; 'цикл вечный'
 &gt;&gt; 'непрерывность выполнения иструкций - это и есть поток. '
 &gt;&gt; 'Если поток в системе один - вся система занята тем, что печатает двойки'
 &gt;&gt; 'если естть другая ф-я, которая печатает в вечном цикле тройки, одновременно с первой - это второй поток'
 &gt;&gt; 'теперь ближе к муду...'

Колдунья Kind произносит 'желательно :)'

 &gt;&gt; 'весь муд - задача, которая в цикле читает из дискриптов данные, обрабатывает их, двигает всякие байты вроде нас туда-сюда и выплевывает каждый пульс нам какую-то пургу.'
 &gt;&gt; 'это один поток управления. Если в какой-нибудь команде мудовской я сделаю вечный цикл, никто больше никаких данных из дискрипторов вычитывать не будет'
 &gt;&gt; 'байты тоже двигаться по комнатам не будут. И мы ничего не увидим. Все повиснет и будет крутит этот цикл.'
 &gt;&gt; 'муд - однопотоковый.'
 &gt;&gt; 'Если этот один поток чем-то занят, он только это и делает.'
 &gt;&gt; 'феня создает очень удобную иллюзию многопотоковости.'
 &gt;&gt; 'предположим, цель написать мобпрогу, которая ждет ответа от чара'
 &gt;&gt; 'при том, в разные моменты, реакция на реплику должна быть разной.'
 &gt;&gt; 'теперь немного отвлечемся...'

 &gt;&gt; 'вот есть скажем, гритпрога'
 &gt;&gt; 'вызывается, когда тело входит в комнату'
 &gt;&gt; 'в этой грит-проге моб говорит здрасти'
 &gt;&gt; 'понятно, что эта прога будет вызвана косвено из кода команды north (или какой-то другой команды, которая втащила тело в комнату с мобом с грит-прогой?'

Колдунья Kind произносит 'откуда она там появилась?'
 &gt;&gt; 'в команде north будет вызвано что-то типа char_to_room, или еще какая-то фигня. В этой фигне есть цикл по всем в комнате. И для тех, у кого есть грит прога - она вызывается.'
 &gt;&gt; 'так же как speech прога вызывается из команды say'

 &gt;&gt; 'важно то, что команда north не закончит выполняться раньше, чем закончится greet прога.'
 &gt;&gt; 'вот это важно.'
 &gt;&gt; 'т.е. если написать в проге вечный цикл - все повиснет.'

 &gt;&gt; 'тоже ясно?'
 &gt;&gt; 'теперь в свете этого, вернемся к написанию мобпроги, которая пытается поздороваться.'

Колдунья Kind произносит 'давай попробуем :)'
 &gt;&gt; 'въехало тело. Моб поднял шляпу... дальше он должен дождаться когда ему ответят.'
 &gt;&gt; 'то, что ответа недолждаться в гритроге - понятно?'
 &gt;&gt; 'невозможно ждать.'
Колдунья Kind произносит 'понятно'
Колдунья Kind произносит 'рыло не сможет ответить'
 &gt;&gt; 'о'
 &gt;&gt; 'в точку'

 &gt;&gt; 'вот для этого нужны потоки.'
Ты счастливо улыбаешься.

Колдунья Kind произносит 'пример :)'

 &gt;&gt; 'моб в гритпроге создает поток, в котором можно ждать.'
 &gt;&gt; 'стой. Еще чуть-чуть теории.'
 &gt;&gt; 'в муде все должны ходить по очереди. иначе не честно'

Колдунья Kind произносит '?!'

 &gt;&gt; 'ну, как в настольной игре..'
 &gt;&gt; 'только раунд - четверть секунды.'
 &gt;&gt; 'потому, нельзя делать планировщик потоков вытесняющим.'
 &gt;&gt; 'есть еще одна техническая причина, по которой этого нельзя делать...'

 &gt;&gt; 'да, что такое вытесняющая-невытсняющая многозадачность - знаешь?'
Колдунья Kind произносит 'не особо'
 &gt;&gt; 'вытесняющий - это когда вечный цикл печатающий двойки насильно прерывается на какое-то время, давая возможность печатать еще и тройки'
 &gt;&gt; 'то есть, процессор один, потоков много и все стоят в очереди в туалет, откуда их с воплями выгоняют через время называемое time slice'
 &gt;&gt; 'не вытисняющая многозадачность - это все точно так же, только потоки ждут, пока выполняющийся сам оттуда не выйдет.'
 &gt;&gt; ''выход' в фене - это .scheduler.yield()'

Колдунья Kind произносит 'ты говорил - это передача исполнения следующему потоку'

 &gt;&gt; 'yield позволяет выполняться другим потокам. Управление к этому потоку вернется после полного оборота. Когда все остальные походют.'
 &gt;&gt; 'выход из туалета %)'
 &gt;&gt; 'поток не завершает выполнение, а замораживается. yield значит 'я походил'.'

Колдунья Kind произносит 'круговая очередь?'
 &gt;&gt; 'угу.'

 &gt;&gt; 'так. теперь пример...'

Колдунья Kind произносит 'а как же оперативное реагирование на действия чувачка - вызов этой туйни из других потоков при возникновении условий благоприятных для нашего конкретного?'
 &gt;&gt; 'чувак не может сделать больше одного действия за один шаг. Так устроен мир.'
 &gt;&gt; 'или я не понял вопроса?'
Колдунья Kind произносит 'но если в определенное время исполняется конкретный поток'
Колдунья Kind произносит 'и возникает ситуация, которя должна быть обработана другим потоком'
Колдунья Kind произносит 'что произойдет?'
 &gt;&gt; 'например?'
Колдунья Kind произносит 'к примеру моб отслеживает мой базар и отвечает'
Колдунья Kind произносит 'базар - поток типа главный'
Колдунья Kind произносит 'действия моба - как бы второстепенный'
Колдунья Kind произносит 'ситуация отслеживается на уровне главного потока?'
 &gt;&gt; 'прога развивается в главном потоке'
Колдунья Kind произносит 'чтобы передать управление второстепенному?'
Колдунья Kind произносит 'но если в проге должен быть получен ответ?!'
Колдунья Kind произносит 'я чето не врублюсь'

 &gt;&gt; 'после того, как были обработаны все ходы чаров и мобов (вандер, агры) будут выполняться потоки фени'

Колдунья Kind произносит 'если условия для них выполнены? или всегда?'

 &gt;&gt; 'всегда. '
 &gt;&gt; 'смотри'
 &gt;&gt; 'вот в нашей задаче с ожиданием ответа на приветствие.'
 &gt;&gt; 'я в грит проге создал поток и запустил его (он выполняться он будет только после того, как все в этом апдэйте походят)'
 &gt;&gt; 'после того как все походили начинает выполняться поток созданный грит прогой'
Колдунья Kind произносит 'так'

 &gt;&gt; 'в нем я говорю привет тому, кто вошел, а дальше зависаю в цикле: for(; hasReply(); ) { .scheduler.yield(); }'

 &gt;&gt; 'каждый апдэйт управление передается этому потоку и пока условие hasReply() не выполнится - я буду вызывать переход хода дальше'

 &gt;&gt; 'та погодь - все просто.'
 &gt;&gt; 'ща напишу - будет понятно'

 &gt;&gt; 'смотри. то, что чарам в фене можно добавлять любые поня знаешь?'
 &gt;&gt; 'поля'
 &gt;&gt; 'eval bububu = 5'
 &gt;&gt; 'создаст у меня полк bububu со значением 5'
 &gt;&gt; 'eval get_char_room("kind").bebe = "hello" создаст у тебя поле bebe со строкой hello'

 &gt;&gt; 'можно написать спичпрогу, которая в поле bebe будет присваивать значение мессаги, которе ей передалось'

 &gt;&gt; 'так вот в потоке моба можно написать так: for(; bebe == null;) { .scheduler.yield(); }'

 &gt;&gt; 'этот цикл будет вызывать yield до тех пор, пока спич прога этого моба не присвоит полю bebe конкретное значение'

Колдунья Kind произносит 'понятно'

 &gt;&gt; 'после этого поток продолжится и можно будет че-то еще замутить.'
 &gt;&gt; 'в еврее есть функции waitSpeech и waitItem, которые _ждут_ когда кто-то что-то сморознет, или что-то даст мобу.'

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; PART 2 (from Filths) &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;

Колдунья Kind говорит тебе 'а можно так сделать, чтобы игроку начислялась экспа за общение с мобом или при прочтении какой-то надписи? на фене'

 &gt;&gt; 'можно все. :) Не для всего есть апи - но это Руффине три строки написать. Сдалать метод чару gain_exp(число)'
 &gt;&gt; 'пиши, будто есть.'
 &gt;&gt; 'там можно что угодно ваять.. касты, команды, пассивные скилы - ваще все что попало.'

Колдунья Kind говорит тебе 'а скажем ловушки магические а-ля существующих можно сделать?'
 &gt;&gt; 'можно'
 &gt;&gt; 'можно сделать даже глобал, а-ля гангстеров'

Колдунья Kind говорит тебе 'круто - дайте что-то почитать'
 &gt;&gt; 'так, сначала надо что-то написать %)'
 &gt;&gt; 'чтоб потом это читать'

Колдунья Kind говорит тебе 'я тут задумал для своей арии написать скрипты для мобов, которые тупо стаей охотится будут'
Колдунья Kind говорит тебе 'как думаешь - реально?'
 &gt;&gt; 'реально'
 &gt;&gt; 'рыжа, когда квест на воровство детей писала, прикрутила правильный поиск в ширину. Для него надо и-фейс в фене написать и будут гоняться хоть по всему миру'

Колдунья Kind говорит тебе 'а у тебя нет случайно списка тех возможностей для мобов которые ты руфине заказывал?'
 &gt;&gt; 'нетути. все что заказывал (почти) уже прикручены. Я ведь только еврея писал, бармена дальтового и гинджа.'
 &gt;&gt; 'все что надо, кроме пут-проги было прикручено.'

Колдунья Kind говорит тебе 'знач все примеры есть в еврее?'
 &gt;&gt; 'да. ганджа пока не работает. Рыжа должна климат пофиксить.'
 &gt;&gt; 'а в дальтовой забегаловке ничего нового нет.'
 &gt;&gt; 'примитивные реакции'
 &gt;&gt; 'ты смотри как делай'
 &gt;&gt; 'если что-то надо, ищи аналог в сишных ф-ях анатолии и говори рыжей, что тебе нужен интерфейс к такой-то ф-ии.'

Колдунья Kind говорит тебе 'что значит аналог в сишной анатолии?'
 &gt;&gt; 'анатолия - это такой муд. На коде этого муда основан наш мир. Анатолия написана на си. Если нужна в фене какая-то из ф-й использованых в анатолии - можно сделать интерфейс, чтоб из фени вызывать эти сишные ф-и.'

Колдунья Kind говорит тебе 'расскажи о том как выполняются сами скрипты'
 &gt;&gt; 'ээ.. лирическое отступление к теории компиляции?'


Колдунья Kind говорит тебе 'если я знаю что мне конкретно например нужно чтобы после разговора у чела прибавлялось экспы, то что нужно сделать?'
Колдунья Kind говорит тебе 'с анатолией ясно'
Колдунья Kind говорит тебе 'зачем именно искать аналог?'
 &gt;&gt; 'чтоб знать чего хочешь. в анатолии есть ф-я gain_exp(жертва, число) - начисляет жертве экспу. Поднимает левел когда надо и т.п.'

Колдунья Kind говорит тебе 'разве руффина сама не может посмотрель реально ли реализовать этот интерфейс?'
Колдунья Kind говорит тебе 'что если аналога в анатолии нету?'
 &gt;&gt; 'руффина прикрутит и скажет: да, прикручено. теперь есть метод gain_exp у чара. Вызывать так: ch.gain_exp(число)'
 &gt;&gt; 'тогда развернуто описываешь чего должна делать ф-я.'

Колдунья Kind говорит тебе 'в общем ясно - но мне нужно знать что уже сделано'
&gt;&gt; 'все есть в еврее, к тому же там рыжая собирается сделать какое-то подобие апи и выслать.'

Колдунья Kind говорит тебе 'ясно, а сборничка каких-то стандартных скриптовых приемов нету? :)'
 &gt;&gt; 'ну кто его напишет? :)'

Колдунья Kind говорит тебе 'ладно, давай тогда поможешь сделать одну задачу'
Колдунья Kind говорит тебе 'а я посмотрю на ход твоих мыслей'
Колдунья Kind говорит тебе 'есть ловушка'
Колдунья Kind говорит тебе 'а-ля той что в клане аутов'
Колдунья Kind говорит тебе 'при попадании в нее чар переносится в другую комнату'
Колдунья Kind говорит тебе 'как сделать чтобы при этом с него снималось еще хп и мана'
Колдунья Kind говорит тебе 'но без убийства персонажа'
 &gt;&gt; 'просишь у рыжей интерфейс к ф-ии damage, или полю hit, если хочешь это делать руками.'
 &gt;&gt; 'чтоб без убийства - надо проверить, чтоб дамага не была больше чем у чара хп.'
 &gt;&gt; 'кроме того, тебе надо будет просить у руффины грит-прогу для комнаты. А-ля как у мобов.'
 &gt;&gt; 'это все можно сделать в грит-проге комнаты, из которой он попадает в ловушку.'
 &gt;&gt; 'переносишь чара в другую комнату, наносишь дамагу и вычитаешь хп.'
 &gt;&gt; 'скажем, onGreet = function(v) { v.char_from_room(); v.char_to_room(внум_другой_комнаты_); v.act("Ты попал"); v.hit = v.hit / 2; }'
 &gt;&gt; 'только вместо внум_другой_комнаты надо .get_room_index(внум_другой_комнаты)'

Колдунья Kind говорит тебе 'как узнать что чар попал в эту комнату именно из ловушки?'
Колдунья Kind говорит тебе 'но ведь это делается автоматически'
Колдунья Kind говорит тебе 'захват в ловушку и перенос'
 &gt;&gt; 'а зачем стандартные ловушки, если есть феня? :)'

Колдунья Kind говорит тебе 'просто там опций много'
Колдунья Kind говорит тебе 'заново переписывать не хочется'
 &gt;&gt; 'какие опции? chance? surface? это просто делается с помощью if(.chance(процент)) ...'
 &gt;&gt; 'а мессаги прям cut&pasteом воткни в act()'

Колдунья Kind говорит тебе 'ну там тип передвижения'
Колдунья Kind говорит тебе 'кроме того мессаги идут не тольк чару в ловушке но и всем в комнате'
 &gt;&gt; 'чтоб сказать всем в комнате - ppl.call.act(...)'
 &gt;&gt; 'чтоб всем, кроме жертвы - ppl.sub(v).call.act()'

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; PART 3 (from Ruffina) &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;

 &gt;&gt; 'сегодня вечером/ночью будет автоматическое API. По крайней мере список полей и методов будет виден. Краткий хелп - чуть позже'

Колдунья Кинд говорит тебе 'в смысле доступен из мира?'
 &gt;&gt; 'да. с помощью eval ptc( &lt;object&gt;.api() )'
 &gt;&gt; 'выведет список полей с коротким описанием каждого'

Колдунья Кинд говорит тебе 'угу, понятно'
Колдунья Кинд говорит тебе 'да, еще - помощь по АПИ надеюсь будет доступна и на тестовом? ибо здесь таким образом какой был указан прочитать не получится'

 &gt;&gt; 'именно на тестовом. тут же у тебя нету прав по фене ботать и eval ты не сможешь сделать'
Колдунья Кинд говорит тебе 'вот и я о том же.. ноту с комментариями напишешь? ибо память моя коротка, а команды помнить надо :)'

Колдунья Кинд говорит тебе 'кстати, а можно ли удалять скрипты из списка code list?'
 &gt;&gt; 'он сам исчезнет, как только исчезнут все ссылки на его ф-ии из мира'

Колдунья Кинд говорит тебе 'а то просто может накопиться куча тестовых примеров'
Колдунья Кинд говорит тебе 'ссылки? надо поторбить Филдса :)'
 &gt;&gt; 'ну там garbage collector есть. у каждого объекта есть счетчик ссылок на него. '
 &gt;&gt; 'когда исчезает последняя ссылка, объект удаляется'
 &gt;&gt; 'то же верно и для функций'
 &gt;&gt; 'если все ф-ии из codesource удалились, то удаляется и codesource'

Колдунья Кинд говорит тебе 'там твоя функция висит - на нее кто-то ссылается?'
 &gt;&gt; 'да'

Колдунья Кинд говорит тебе 'кто?!'
 &gt;&gt; 'например, есть моб с мобпрогой'
 &gt;&gt; 'а мобпрога - это функция. на нее ссылается переменная моба'
 &gt;&gt; 'когда моб умрет, исчезнет и прога'


Колдунья Кинд говорит тебе 'а вот я к примеру написал ту же строчку что у тебя и сделал eval - почему она там висит?'
 &gt;&gt; 'какую строчку? ты мог этим eval-ом присвоить самому себе некую переменную. и пока она есть - будет висеть'
 &gt;&gt; 'при eval ptc(2+2)  codesource будет создан, но тут же и разрушен, т.к. никаких ссылок не создается.'

Колдунья Кинд говорит тебе 'подожди, а если к примеру еврея кто-то убьет, то исчезнет и прога?'
 &gt;&gt; 'дело в том, что прога не на еврее, а на его mob index data. Т.е. на структуре, которая соотвествтует описанию еврея в арии'
 &gt;&gt; 'если бы висела прямо на еврее, то исчезла бы. А так - каждый новый еврей уже рождается с этой прогой :)'

 &gt;&gt; 'похоже, логи ваших бесед с Филдсом и эти разговоры впору выкладывать куда-то. &gt;8)'
 &gt;&gt; 'потому как если еще кто-то заинтересуется, придется рассказывать все сначала'
Колдунья Кинд говорит тебе 'точно'

Колдунья Кинд говорит тебе 'так значит я создал у себя переменную, которая указывает на функцию? и как от нее избавиться?'
 &gt;&gt; 'присвой ей null'
 &gt;&gt; 'это не переменная, а поле объекта. а объект - ты сам. '
 &gt;&gt; 'скорее всего, я ж не знаю что за eval был..'

Колдунья Кинд говорит тебе 'eval bubu = null?'
Колдунья Кинд говорит тебе ':)'
 &gt;&gt; 'ага'

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; PART 4 (from Filths) &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;

Колдунья Kind говорит тебе 'расскажешь как вообще выполняется скрипт? :)'
Колдунья Kind говорит тебе 'вот ты вчера писал для сатира'
 &gt;&gt; 'чтоб на bubu реагировал?'

Колдунья Kind говорит тебе 'и с ходу влепил функцию которая определяет, что нужно использовать обьект типа сатир'
Колдунья Kind говорит тебе 'почему использовался сатир именно из той комнаты?'
Колдунья Kind говорит тебе 'там есть какие-то привязки к месту действия?'

 &gt;&gt; 'потому, что _я_ стоял в этой комнате. ща объясню какая тут связь. Ты знаешь что такое this в c++?'
Колдунья Kind говорит тебе 'конечно'
 &gt;&gt; 'так вот выражение, которое передается eval'у в параметры интерпретируется с this == тому, кто выполняет команду.'
 &gt;&gt; 'соответственно метод get_char_room("satyr") - мой метод. полная запись this.get_char_room("satyr"), но this можно опускать'
 &gt;&gt; 'для краткости'
 &gt;&gt; 'eval ptc("hello world") - вызывает метод чара ptc. именно поэтому hello world напишется именно тебе.'
 &gt;&gt; 'если тынаришешь get_char_room("satyr").ptc("hello") - "hello" попадет сатиру в той же комнате, что и ты.'

Колдунья Kind говорит тебе 'понятно, значит желательно знать структуру класса _Я_ :)'

Колдунья Kind говорит тебе 'что такое ptc?'
 &gt;&gt; 'метод чара. сокращение от print to char'

 &gt;&gt; 'тут есть еще один момент..'
 &gt;&gt; 'есть метод get_char_world() - она ищет чара по _всему_ миру. Это метод не чара, а мира. (корневого объекта)'
 &gt;&gt; 'к ней надо обращаться по полному пути. то есть, начиная с точки - .get_char_world()'

Колдунья Kind говорит тебе 'гм, а если таких будет нескольно - первого найденого? или всех?'
 &gt;&gt; 'не может быть двух одинаковых методов у одного объекта.'
 &gt;&gt; 'может быть ф-я с тем же именем в корневом объекте, но к ней ты обратиться сможешь только через точку.'

Колдунья Kind говорит тебе 'я не о методах'
Колдунья Kind говорит тебе 'я говорю а чарах - если их будет несколько - команда выполнится для одного или для всех?'
 &gt;&gt; 'тот же что найдется c gate или c summon :)'
Колдунья Kind говорит тебе 'только с гейт, грустно ('

 &gt;&gt; 'у функций в фене нет имен и нет типов. имена есть у переменных, содержащих указатели на ф-ю. Этот указатель можно переопределять в общем случае.'
 &gt;&gt; 'в с++ перегрузка осуществляется за счет типизации ф-й и хитрой символической записи имен ф-й для линковки (mangle).'
Колдунья Kind говорит тебе 'ладно - нету и хорошо :)'
 &gt;&gt; 'дк, нечего перегружать. Вот в чем дело :)'

 &gt;&gt; 'с namescope тебе все ясно было?'
Колдунья Kind говорит тебе 'типа да'
Колдунья Kind говорит тебе 'хотя особо и не вникал'

 &gt;&gt; 'разница между function() { var a; a = 5; } и function() { a = 5; } ясна?'
 &gt;&gt; 'скомпиллится и запустится и то и другое, но смысл разный'
Колдунья Kind говорит тебе 'не особо'
Колдунья Kind говорит тебе 'разве что без вар будет использоваться переменная более высокой области видимости?'

 &gt;&gt; 'в первом случае - 'a' это переменная. во втором - поле.'
Колдунья Kind говорит тебе 'поле чего?'
 &gt;&gt; 'this :)'
 &gt;&gt; 'дк, в с++ так же.'
 &gt;&gt; 'разница в том, что в си компиллер ругнется если в классе не объявлена перемнная 'a'. а в фене это поле просто добавится объекту.'


Колдунья Kind говорит тебе 'а как из фунции можно получить доступ к данным, которые выше ее?'
 &gt;&gt; 'что значит 'выше'? область видимости начинается с описания ф-ии. Если нужны какие-то другие объекты - передай в параметры.'

Колдунья Kind говорит тебе 'но если есть глобальная или статическая переменная, то он попытается использовать ее, а как здесь?'
 &gt;&gt; 'здесь нет глобальных переменных, зато вместо этого есть рутовый объект.'

Колдунья Kind говорит тебе 'рутовый обьект виден везде?'
 &gt;&gt; 'рутовый объект (.) виден отовсюду.'
 &gt;&gt; 'можешь считать, что this - это текущий каталог, а рутовый объект - это корневой каталог.'

Колдунья Kind говорит тебе 'а доступ к другим можно получить с помощью методов корневого?'
 &gt;&gt; 'да. ну, или через  ссылки из текущего.'

Колдунья Kind говорит тебе 'тогда все выглядит довольно логично'
 &gt;&gt; ':)'

 &gt;&gt; 'то, что объявлено как переменная - переменная. что не объявлено - поле this. Если указан полныйпуть (например .tmp.restring) - путь от корневого объекта'

 &gt;&gt; '*itch* шо-то еще было..'
 &gt;&gt; 'а.. что про потоки говорил - понятно?'
Колдунья Kind говорит тебе 'понятно вроде'

 &gt;&gt; 'бэктрэйс'
 &gt;&gt; 'и ваще, про команду codesource рыжая говорила?'
Колдунья Kind говорит тебе 'только в общих чертах'

 &gt;&gt; 'ну, вещи, которые не в одну строку положено постить через команду codesource'
Колдунья Kind говорит тебе 'как именно'
 &gt;&gt; 'там как ноту пишешь. codesource subj мой скрипт v1.0'
 &gt;&gt; 'потом codesource + построчно программу.'
 &gt;&gt; 'потом, codesource post, или что то же самое codesource eval делаешь и оно компилится и вычисляется.'
 &gt;&gt; 'текст, ктоорый в codesource + пишется - то же что и в параметры eval. только можно больше впихнуть, и если есть ошибки - будет виден номер строки.'

&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; PART 5 (from Filths) &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
Un Kind ПОЕТ:'как здорово, что все мы здесь сегодня собрались'

Un Kind говорит тебе 'расскажи подробнее о еврее'
 &gt;&gt; 'а поцчему ви спрашиваете? ви что, антисемит? :)'
Un Kind говорит тебе 'как происходит его становление как еврейской личность?'
Un Kind говорит тебе ':)'

[ooc] Антисемитка Kind : 'скорее так'

 &gt;&gt; 'как нанего вешаются проги? Или как они потом работают?'
 &gt;&gt; 'о!'
 &gt;&gt; 'забыл про this'
 &gt;&gt; 'евреем напомнило'
 &gt;&gt; 'если походу присвоить this новое значение, то оно присвоится и все будет будто теперь это метод другого объекта.'

Антисемитка Kind говорит тебе 'а для прежнего обьекта? что с ним?'
 &gt;&gt; 'ничего. что с ним станется. Можешь даже запомнить в левую переменную старый this, поменять его, а потом восстановить. Можешь не восстанавнивать.. безразницы.. Вообще - this - это локальная переменная, так же как и все аргументы ф-ии'

Антисемитка Kind говорит тебе 'давай о евреях? :)'

 &gt;&gt; 'ща еще одно. Там в еврее это использовалось'
 &gt;&gt; 'чтоб было понятно что происходит.'
 &gt;&gt; 'если описать ф-ю так: function(a, this, b) { }'
 &gt;&gt; 'а вызвать ее так: a.zzz(1, 2, 3) то this будет не 'a', а '2''
 &gt;&gt; 'это понятно?'

Антисемитка Kind говорит тебе 'типа аргумент является локальным параметром функции?'
 &gt;&gt; 'аргумент и параметр - синонимы.. не очень понял вопроса..'
 &gt;&gt; 'давай так опишу'

Антисемитка Kind говорит тебе 'аргумент - локальная переменна'
 &gt;&gt; 'да.'
Антисемитка Kind говорит тебе 'вот'

&gt;&gt; 'а this - неявный аргумент, но его как и любую переменну можно переопределить.'
 &gt;&gt; 'если в списке параметров есть this, то значение this будет определятся не объектом, над которым производят действие, а значением параметра'

Антисемитка Kind говорит тебе 'есть примеры использования?'
Антисемитка Kind говорит тебе 'ну, где это может быть полезным?'

 &gt;&gt; 'да. В еврее.'
 &gt;&gt; 'там некоторые ф-ии, описаны так'


Антисемитка Kind говорит тебе 'зачем переопределять this например по ходу исполнения функции?'
 &gt;&gt; 'чтоб короче было писать'
 &gt;&gt; ''this.' можно не писать'

Антисемитка Kind говорит тебе 'и непонятней:?'
 &gt;&gt; 'почему же?'

Антисемитка Kind говорит тебе 'мало ли, человек может случайно упустить момент перехода к новому обьекту'
&gt;&gt; 'не. таких мест нету. но есть function(this) }'
Антисемитка Kind говорит тебе 'ну тут не поспоришь - действительно полезно'

Антисемитка Kind говорит тебе 'если обрабатывать значительное количество полей то конечно да'
 &gt;&gt; 'так, именно для этого'
 &gt;&gt; 'никто не говорит о том, чтоб туда-сюда дергать this. я просто объяснял что это обычная локальная переменная с хитрым имерем'

Антисемитка Kind говорит тебе 'это ясно, давай о том как прога на еврея вообще вешается?'
 &gt;&gt; 'то, что дала тебе рыжая - готовый текст, который можно впихнуть в eval, или codesource. Это выражение, являющееся присваиванием. Влевой части стоит поле чара jewInit, в правой - констана, являющаяся ф-ей.'
 &gt;&gt; 'после eval, или codesource post выполняется присваивание и у того, кто это выполнял появляется поле jewInit'
 &gt;&gt; 'дальше делаешь eval jewInit() и этот метод запускается.'
 &gt;&gt; 'я тут открыл его, бо не помню нифига'
 &gt;&gt; 'ага. Типа, создается временная переменная jew и инициализируется пустой структурой.'

 &gt;&gt; 'О. вот как раз еще один важный момент.'
 &gt;&gt; 'В фене принято (ну, не только) типы называть с большой буквы.'
 &gt;&gt; 'феня не типизированый язык, тем не менее есть объекты и их конструкторы. Вот конструкторы и принято называть с большой буквы.'
 &gt;&gt; '.Map() - это конструктор пустой структуры. То есть это функция, возвращающая объект..'
 &gt;&gt; 'новый'
 &gt;&gt; 'при образщении к полям этого объекта они будут в него добавляться.'

 &gt;&gt; 'ладно. тогда на пальцах'
 &gt;&gt; 'короче, есть у корневого объекта такой метод: .get_mob_index(число)'

 &gt;&gt; 'а.. что такое mob index знаешь?'
Антисемитка Kind говорит тебе 'догадываюсь'
Антисемитка Kind говорит тебе 'что-то типа внума моба?'

 &gt;&gt; 'это прототип мобов. То, что в арии пишется. один внум - одно index data. прототип, как бы.'
 &gt;&gt; 'скажем, прототип и фидов один, а их самих - как собак не резаных'
 &gt;&gt; 'время жизни у него с момента загрузки мира, и до шатдауна. (удалять мобов из olc низя. можно только метить, чтоб в эриа-файлы не сохранялись)'
 &gt;&gt; 'вот у этих index data есть набор полей (onGreet, onSpeech, и т.п), которые могут содержать указатели на ф-ии с мобпрогами.'

 &gt;&gt; 'Вот, значит в ф-ии инициализации еврея я делаю var ndx;  ndx = .get_mob_index(его_внум); ndx.onGreet = ...; ndx.onSpeech = ...; и т.п.'
 &gt;&gt; 'вот вместо ... стоят ф-ии мобпрог, реакций на события.'
 &gt;&gt; 'они вызываются с this == mob index data, а впараметры передается моб с этим mob index data, жертва (кто вошел) и, если это speech-прога, то базар'

 &gt;&gt; 'в грит-проге я создаю новый поток и пускаю его. При этом я передаю в параметры ф-ии потока всю нужную пургу (самого еврея, и жертву)'
 &gt;&gt; 'в ф-ии потока я здоровуюсь, жду ответов... и т.п..'
 &gt;&gt; 'вобщем, все..'

Антисемитка Kind говорит тебе 'круто'
 &gt;&gt; 'там много лишнего...'

Антисемитка Kind говорит тебе 'а откуда вызывается сама функция jewInit?'
 &gt;&gt; 'ее пускать надо руками. eval'ом. После того как запостился codesource'

Антисемитка Kind говорит тебе 'она еврея сама создает? или фунцию уже к существующему мобу привязывает?'
 &gt;&gt; 'нет. Я ж говорил - она ищет прототип еврея по vnum-у и обвешивает прототип. Еврея может и не быть вообще. Убили, или там еще что.'
 &gt;&gt; 'прототип она не создает. Она ожидает, что он уже есть с таким-то внум-ом.'

Антисемитка Kind говорит тебе 'а если еврея прибили?'
Антисемитка Kind говорит тебе 'то пока прогу не перезапустить эта харя ничем особенным отличаться не будет?'
 &gt;&gt; 'он ресетнится, рано или поздно. Будет. Смотри'
 &gt;&gt; 'у моба есть поле pIndexData - это указатель на его прототип. Когда кто-то вваливается в комнату, сначала вызывается mob.pIndexData.onGreet(), а потом mob.onGreet()'
 &gt;&gt; 'на конкретном мобе может ничего не висеть, если висит на прототипе'

Антисемитка Kind говорит тебе 'что-то типа наследования?'
 &gt;&gt; 'когда писали merc об этом не думали :) Тут скорее factory.'

Антисемитка Kind говорит тебе 'и что пишется в поле  pIndexData для прототипа?'
 &gt;&gt; 'у прототипа нет поля pIndexData'

Антисемитка Kind говорит тебе 'в поле onGreet'
 &gt;&gt; 'в поле onGreet прототипа?'
 &gt;&gt; 'грит-прога. Ф-я, которая запускается, когда кто-то входит в комнату с мобом созданным по этому прототипу'

 &gt;&gt; 'это. Надо показать на примере.'

 $ eval kind = .get_char_world("kind")
 $ eval ptc(kind == null)
0

 $ eval (kind.char_from_room(), knid.char_to_room(in_room))
Runtime exception Null pointer dereference
   in cs #37 (&lt;eval command&gt;) line 1: knid.char_to_room(in_room)
   Ya-ma-ta!

-:- mud.kiev.ua:9002: connection closed by foreign host.


 $ eval kind = .get_char_world("kind")
 $ eval ruffina = .get_char_world("ruffina")
 $ eval (kind.char_from_room(), kind.char_to_room(in_room))

(Прозрачно)Kind здесь.
Ты хихикаешь.

 $ eval (ruffina.char_from_room(), ruffina.char_to_room(in_room))
Ты хихикаешь.
Ruffina хватается за голову.

 &gt;&gt; 'так... гритпрога..'

 $ eval ptc(get_char_room("satyr").pIndexData.vnum)

 &gt;&gt; 'eval ptc(get_char_room("satyr").pIndexData.vnum)'

Антисемитка Kind произносит 'это что?'
 &gt;&gt; 'это внум этого моба'

 &gt;&gt; '.get_mob_index(12023) == get_char_room("satyr").pIndexData'
 &gt;&gt; 'это один и тот же объект.'
 &gt;&gt; '.get_mob_index(12023) существует даже если всех сатиров перебили (ни дай бог)'

Антисемитка Kind произносит 'а почему не выполняется  eval ptc(.get_mob_index(12023))'
 &gt;&gt; 'потому, что это объект, а не строка.'
 &gt;&gt; 'ptc печатает строки, или то, что к ним моет привестись'

Тихий голос из Новогоднего шара: Dredd появился в Dream Land.
Антисемитка Kind хихикает.

[ooc] Dredd : 'anuka Kind obkastuy menya :)'
[ooc] Антисемитка Kind : 'да ты батляра позорный в пятом колене'
[ooc] Dredd : ':)'
[ooc] 'от я его сейчас обкастую. Давай нанего проги вешать? %)'
Антисемитка Kind хихикает.

[ooc] Dredd : 'zbozhenci :)'
[ooc] Dredd : 'a kto rul Battlov ?'
[ooc] Dredd : 'auuu'

 $ eval dredd = .get_char_world("dredd")
 $ eval dredd.interpret("Я")

 $ eval dredd.interpret("ooc (глупо хихикает)")
[ooc] Dredd : '(глупо хихикает)'

 $ eval (dredd.char_from_room(), dredd.char_to_room(in_room))
Ты хихикаешь.
[ooc] Dredd : 'shto za Anarhiya zdes tvoritsya ???'

Dredd осматривает все вокруг.

 $ eval dredd.interpret("bonk self")
Dredd стукает себя по шлему и морщится от боли.
Ты хихикаешь.
Антисемитка Kind хлопает в ладоши.
Dredd поднимает бровь, глядя на странные действия Антисемитка Kind.
Антисемитка Kind произносит 'страшно?'

 $ eval dredd.interpret("shiver")
Dredd дрожит от страха.

 $ eval in_room.ppl.call.act("Потолок падает тебе голову!")
Потолок падает тебе голову!

 $ eval dredd.interpret("wave")
Dredd счастливо машет.

 $ eval dredd.interpret("quit")
Тихий голос из Новогоднего шара: Dredd покинул Dream Land.

Тихий голос из Новогоднего шара: Dredd появился в Dream Land.
Dredd появился в этом мире.
Антисемитка Kind падает на землю и катается в приступе истеричного смеха.
Ты валишься с ног от усталости.
Dredd произносит 'sho za h..'
Dredd осматривает все вокруг.

 &gt;&gt; 'тут не играют. Это тестовый сервер'
 &gt;&gt; 'тут билдят и скрипты тестят.'

Dredd произносит 'eh povalil ya navernoe'
Dredd произносит 'Kind xaydi na DL'

Антисемитка Kind произносит 'а почему у меня не катит'
Антисемитка Kind произносит 'eval dredd.interpret("wave")'
 &gt;&gt; 'потому, что это моя переменная. Можешь себе такую сделать.'

Dredd галантно приподнимает его шляпу.
Тихий голос из Новогоднего шара: Dredd покинул Dream Land.

 &gt;&gt; 'eval dredd = .get_char_world("dredd")'
 &gt;&gt; 'поздно'

Тихий голос из Новогоднего шара: Dredd появился в Dream Land.
Dredd появился в этом мире.
Антисемитка Kind кивает.
 &gt;&gt; 'о'

Dredd бьется головой об стенку, уверяя всех что он полный ИДИОТ!
Антисемитка Kind произносит 'гм, получается'

Dredd хихикает.
Dredd счастливо машет.
Dredd засыпает.

Тихий голос из Новогоднего шара: Dredd покинул Dream Land.

 &gt;&gt; 'вот, кстати и dredd нет pIndexData. Это не моб.'
 &gt;&gt; 'как ни странно'

 $ eval .get_obj_index(3000).create().obj_to_char(this)

 &gt;&gt; 'eval .get_obj_index(3000).create().obj_to_char(this)'
 &gt;&gt; '3000 - это бочонок пива'


 $ eval get_char_room("satyr").pIndexData.onGreet = function(m, v) { m.interpret("emote улыбается"); }

 $ e
На Грязной Тропе
(Прозрачно)Ешу (eshu) сидит здесь, рассказывая о мириадах своих приключений.
Сатир (satyr) с бутылкой в одной руке и женщиной в другой сидит здесь.
Сатир-пьяница улыбается
Сатир-пьяница улыбается

 $ w
(Прозрачно)Kind здесь.
Сатир (satyr) с бутылкой в одной руке и женщиной в другой сидит здесь.
Сатир-пьяница улыбается
Сатир-пьяница улыбается

 &gt;&gt; 'два раза - это он крысе улыбнулся'
 &gt;&gt; 'eval get_char_room("satyr").pIndexData.onGreet = function(m, v) { m.interpret("emote улыбается"); } '
 &gt;&gt; 'это на ВСЕХ сатиров с этим vnum-ом'
 &gt;&gt; 'там на east такой же'

 $ cs l
CodeSources in use:
[2] Ruffina: &lt;eval command&gt;
[41] Filths: &lt;eval command&gt;

 &gt;&gt; 'почему там m.interpret, а не просто interpret - понятно?'
Антисемитка Kind произносит 'иначе улыбался бы ты?'
 &gt;&gt; 'нет. я это v. this был бы - прототип. а у прототипа нет метода interpret'

Ешу-сказочник прилетел с востока.
Сатир-пьяница улыбается

 &gt;&gt; 'можно так:'
 &gt;&gt; 'eval get_char_room("satyr")onGreet = function(v) { interpret("emote улыбается"); } '
 &gt;&gt; 'точку перед onGreet пропустил'
 &gt;&gt; 'тут у грит проги всего один аргумент - жертва. а this - это моб на которого повесили прогу.'
 &gt;&gt; 'при этом прога будет висеть только на нем и если его прибить, она пропадет и все новые мобы будут без проги.'

&gt;&gt; 'так.. с потоками..'

 $ eval get_char_room("satyr").pIndexData.onGreet = function(m, v) { .scheduler.Thread(function(a, b) { a.interpret("emote улыбается"); }, m, v).start(); }

 $ e
На Грязной Тропе
Сатир (satyr) с бутылкой в одной руке и женщиной в другой сидит здесь.
Сатир-пьяница улыбается
Сатир-пьяница улыбается

 $ w
(Прозрачно)Kind здесь.
Сатир (satyr) с бутылкой в одной руке и женщиной в другой сидит здесь.
Сатир-пьяница улыбается
Сатир-пьяница улыбается

 &gt;&gt; 'eval get_char_room("satyr").pIndexData.onGreet = function(m, v) { .scheduler.Thread(function(a, b) { a.interpret("emote улыбается"); }, m, v).start(); } '
 &gt;&gt; 'это с потоком.'


Антисемитка Kind произносит 'понятно, значит jewInit висит на прототипе и запускается когда каждый новый перс входит в комнату?'
 &gt;&gt; 'нет. jewInit() висит на том, кто прикручивает мобпрогу. И запускается она единственный раз.'
 &gt;&gt; 'внутри jewInit я ищу mob index data еврея и вешаю на него грит и прочие проги.'


 $ eval ptc(get_char_room("satyr").pIndexData.onGreet)
function 10 (m, v) {
   .scheduler.Thread(function 9 (a, b) {
       a.interpret("emote улыбается");
   } , m, v).start();
}

 &gt;&gt; 'eval ptc(get_char_room("satyr").pIndexData.onGreet)'
 &gt;&gt; 'в таком виде оно понятней.'

 &gt;&gt; 'апи не поможет понять концепций и когда и что делать :)'
Антисемитка Kind произносит 'да, но зато может дать идеи к экспериментированию, что помогает быстрее понять идеи и что и когда делать'
Антисемитка Kind произносит 'следовательно - косвенно понять помогает )'

 &gt;&gt; 'может быть. ты ptc последний посмотрел?'
Антисемитка Kind произносит 'eval ptc(get_char_room("satyr").pIndexData.onGreet)?'
 &gt;&gt; 'да'
Антисемитка Kind кивает.
 &gt;&gt; 'там понятно все?'

Антисемитка Kind произносит 'при заходе чувака в комнату запускается поток, который мне улыбается, успешно завершается что немаловажно и все идет своей дорогой'
 &gt;&gt; 'то, почему в первом варианте промпт выводился после улыбания, а в этом до - понятно?'

Антисемитка Kind произносит 'ну типа поток выполняется до того, как пойдут команды отвечающие за вывод промпт'
Антисемитка Kind произносит 'вызывается из команды движения'
 &gt;&gt; 'наоборот. Поток выполнится позже'

Антисемитка Kind произносит 'тю'
Антисемитка Kind произносит 'спутал'

 &gt;&gt; 'команда движения отработает, выдастся промпт. И только потом будет выполняться поток'
 &gt;&gt; 'с передачей параметров ф-ии потока тоже все понятно?'
Антисемитка Kind произносит 'а что может быть неясного? что имена другие?'
 &gt;&gt; 'переменные m и v недоступны из вложенной ф-ии потока'
 &gt;&gt; 'они могли быть такими же, но общего между ними ничего нет. Чтоб передать потоку какие-то параметры, их надо передавать ф-ии Thread после самой ф-ии'

Антисемитка Kind произносит 'и ты передаешь их ей через параметры самой фунции Thread'
 &gt;&gt; 'именно'
 &gt;&gt; 'от какого объекта вызывается .start() тоже должно быть понятно'
 &gt;&gt; 'start не выполняет код функции, а только заносит ее в конец очереди ожидающих выполнения'
 &gt;&gt; 'ща немного усложним. и с потоками больше нудить не буду.'


 &gt;&gt; 'eval get_char_room("satyr").pIndexData.onGreet = function(m, v) { .scheduler.Thread(function(a, b) { var i; for(i=0;i&lt;5;i=i+1) { a.interpret("emote улыбается " + i); .scheduler.yield(); } }, m, v).start(); } '

 $ e
На Грязной Тропе
Сатир (satyr) с бутылкой в одной руке и женщиной в другой сидит здесь.
Знатная сидхэ (sidhe) гордо осматривает свои владения.
Сатир-пьяница улыбается 0
Сатир-пьяница улыбается 0


Сатир-пьяница улыбается 1
Сатир-пьяница улыбается 1


Сатир-пьяница улыбается 2
Сатир-пьяница улыбается 2


Сатир-пьяница улыбается 3
Сатир-пьяница улыбается 3


Сатир-пьяница улыбается 4
Сатир-пьяница улыбается 4

 $ w
(Прозрачно)Kind здесь.
Сатир (satyr) с бутылкой в одной руке и женщиной в другой сидит здесь.
Сатир-пьяница улыбается 0
Сатир-пьяница улыбается 0


Сатир-пьяница улыбается 1
Сатир-пьяница улыбается 1


Сатир-пьяница улыбается 2
Сатир-пьяница улыбается 2


Сатир-пьяница улыбается 3
Сатир-пьяница улыбается 3


Сатир-пьяница улыбается 4
Сатир-пьяница улыбается 4

 $ eval ptc(get_char_room("satyr").pIndexData.onGreet)
function 12 (m, v) {
   .scheduler.Thread(function 11 (a, b) {
       var i;
       
       
       for (i = 0; i &lt; 5; i = i + 1) {
           a.interpret("emote улыбается " + i);
           .scheduler.yield();
       }
   } , m, v).start();
}

 &gt;&gt; 'eval ptc(get_char_room("satyr").pIndexData.onGreet)'
 &gt;&gt; 'если убрать yield - все будет сплошным блоком одновременно'

 &gt;&gt; 'дальше как фантазия подскажет, так и юзай yield'
 &gt;&gt; 'очень приятно то, что между yield'ами НИЧЕГО произойти не может'
 &gt;&gt; 'то есть, никто не покинет комнаты, если ты его сам не выгонишь в скрипте и т.п.'
Антисемитка Kind произносит 'в смысле?'
 &gt;&gt; 'никто не скажет ничего.'
 &gt;&gt; 'все события для скрипта происходят пока он внутри yield'
 &gt;&gt; 'мир стоит на месте, ожидая пока скрипт не завершится, или не вызовит yield'
 &gt;&gt; 'никто не сможет ввести команду, ничего не вышлется клиентам. Вообще ничего. Работает только твой скрипт.'

Антисемитка Kind произносит 'ну это да'
Антисемитка Kind произносит 'приятно'

 &gt;&gt; 'если цикл сделать вечным и убрать yield - все повиснет.'
 &gt;&gt; 'но стремно :)'

 &gt;&gt; 'так устроена невытисняющая многозадачность'
 &gt;&gt; 'приятно, что не надо заморачиваться, что кто-то выдернет стул из-под ж-пы.'
 &gt;&gt; 'зато никто ничего не сделает, пока форматируется дискетка. :)'

 &gt;&gt; 'так винда 3.11 была сделана'
 &gt;&gt; 'потому виндовые задачи там сосуществовали, а досовские - нет.'
 &gt;&gt; 'для операционки это не годится, а для пошаговой игры - то, что надо'

 $ cs l
CodeSources in use:
[2] Ruffina: &lt;eval command&gt;
[50] Filths: &lt;eval command&gt;

 $ cs r 50
[50] Filths: &lt;eval command&gt;
get_char_room("satyr").pIndexData.onGreet = function(m, v) { .scheduler.Thread(function(a, b) { var i; for(i=0;i&lt;5;i=i+1) { a.interpret("emote улыбается " + i); .scheduler.yield(); } }, m, v).start(); }

 &gt;&gt; 'теперь тебе осталось постичь только апи :)'

Антисемитка Kind произносит 'а скажем для комнаты нечто похожее есть?'
 &gt;&gt; 'greet-тригер?'
Антисемитка Kind произносит 'к примеру'
 &gt;&gt; 'мне не надо было, значит, наверное, нет. надо - будет. '
 &gt;&gt; 'но думай шире'
Антисемитка Kind произносит '? :)'
 &gt;&gt; 'она есть есть у объекта. можно бросить в комнату объект без лонга. :) Но проще рыжей сказать, что такой тригер нужен и он будет'

</pre>
