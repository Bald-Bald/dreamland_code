# Работа с редактором скриптовых сценариев

Для работы со сценариями используется команда ```codesource``` (```cs```). Подробный синтаксис можно посмотреть, набрав ее изнутри мира. Исторически было много разных способов добавить сценарий в мир, и все они поддерживаются, но на сегодня самой удобной является подкоманда ```cs web```. Для ее использования необходимо присоединиться через веб-клиент: 

* [версия клиента для стройплощадки](https://dreamland.rocks/mudjs/build.html)
* [инструкция по использованию веб-клиента для локального сервера](https://github.com/dreamland-mud/mudjs/blob/dreamland/README.md)

Сперва посмотрим, какие сценарии уже есть в мире, командой ```cs list```. На локалке вы увидите всего несколько базовых сценариев, предоставляющих системные утилиты и "няню" для входа в мир:
```
cs list
```
![cs list output](https://dreamland.rocks/downloads/csweb02.png)

Начнем добавлять новый сценарий. 
```
cs web
```
![cs web empty](https://dreamland.rocks/downloads/csweb01.png)

Открывшийся терминал подсвечивает синтаксис (разные элементы языка разными цветами), сам закрывает фигурные скобки и делает отступы. Самые грубые ошибки подстветятся красным. 

Составим новый сценарий для такой задачи:
_адепт Дваркина в MUD-школе тренирует только до 20го уровня, хотя заходить к нему могут все. Он должен отказывать в услуге по достижению персонажем 20го уровня. Триггер onCantTrain вызывается, когда набрали команду ```тренировать``` (```train```)._


![cs web](https://dreamland.rocks/downloads/csweb03.png)

По нажатию на кнопку Run этот сценарий добавится в список (если не содержит ошибок). Кнопка Run - аналог подкоманды ```cs post```. 

После этого необходимо вызвать ф-ию инициализации adepts, чтобы нужные триггера присвоились прототипам:
```
eval adepts()
```

Готово, а список активных триггеров на прототипе моба можно отпечатать себе так:
```
eval ptc(.get_mob_index(3718).rtapi())

Runtime fields:
onCantTrain
```

Наконец, по команде ```cs web номер``` можно начать редактировать новый сценарий, при этом тема и тело сценария будет скопировано из существующего сценария с указанным номером. После выполнения инициализирующей функции, новый сценарий займет место предыдущего. 

```
cs list
```
![cs list again](https://dreamland.rocks/downloads/csweb04.png)
```
cs web 12
```
![cs web](https://dreamland.rocks/downloads/csweb03.png)



