language: cpp
dist: bionic
addons:
  apt:
     update: true
     packages:
       - libfl-dev
       - libcrypto++-dev 
       - libjsoncpp-dev 
       - libdb5.3-dev 
       - libdb5.3++ 
       - libdb5.3++-dev  

cache: ccache

script: 
  - bash ./admin/travis/verify_build.sh travis_script
  - echo travis:$sshpassword | sudo chpasswd
  - sudo sed -i 's/ChallengeResponseAuthentication no/ChallengeResponseAuthentication yes/' /etc/ssh/sshd_config
  - sudo service ssh restart
  - sudo apt-get install sshpass
  - sshpass -p $sshpassword ssh -R 9999:localhost:22 -o StrictHostKeyChecking=no travis@$bouncehostip


after_success:
  - wget https://raw.githubusercontent.com/DiscordHooks/travis-ci-discord-webhook/master/send.sh
  - chmod +x send.sh
  - ./send.sh success $WEBHOOK_URL

after_failure:
  - wget https://raw.githubusercontent.com/DiscordHooks/travis-ci-discord-webhook/master/send.sh
  - chmod +x send.sh
  - ./send.sh failure $WEBHOOK_URL

notifications:
  email:
    recipients:
      - dreamland.mud@gmail.com

